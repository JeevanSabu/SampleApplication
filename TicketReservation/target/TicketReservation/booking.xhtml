<?xml version = "1.0" encoding = "UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns = "http://www.w3.org/1999/xhtml"
   xmlns:f = "http://java.sun.com/jsf/core"    
   xmlns:h = "http://java.sun.com/jsf/html"
   xmlns:p = "http://primefaces.org/ui">
   
   <h:head>
      <title>Ticket Reservation|New Booking</title>
      <h:outputStylesheet library = "css" name = "styles.css"  /> 
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"/>	
      <h:outputStylesheet name="primeicons/primeicons.css" library="primefaces" />
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"/>
      <h:outputScript library = "js" name = "script.js"  /> 
   </h:head>
 
   <h:body>
	<header class="header booking-header">
	   Booking Page
	   <h:form id="user_icon_form" styleClass="user-icon-form">  
		    <p:commandLink id="user_icon_button">
		    	<i class="pi pi-user icon home-user-icon float-right"></i>
		    </p:commandLink>    
		    <p:overlayPanel id="user_overlay_panel" styleClass="user-overlay-panel" for="user_icon_button" hideEffect="fade">
		    		<p:panelGrid columns="2" cellpadding="10" styleClass="overlay-panel-grid no-border">
				        <h:outputText value="Username : " />
				        <h:outputText value="#{userBean.username}" />
				        <h:outputText value="Last Login : " />
				        <h:outputText value="#{userBean.lastLogin}" />
				        <h:inputHidden/>
				        <p:commandButton id="logout_button" value="Log Out" action="#{userModel.logout}" styleClass="logout-button"/>
		    		</p:panelGrid>
		    </p:overlayPanel>
	    </h:form>
	</header>
	<h:form id="booking_form" sgtyleClass="booking-form">
	 
	    <p:dataView id="bus_list" styleClass="bus-list" var="bus" value="#{busView.buses}">
	 
	        <p:dataViewListItem styleClass="bus-list-dataview">
	            <h:panelGrid columns="3" style="width:100%" styleClass="bus-list-dataview-panel" columnClasses="busitem,detail">
	 
	                <p:outputPanel>
	                    <h:panelGrid columns="2" cellpadding="5">
	                        <h:outputText value="Bus Id" />
	                        <h:outputText value="#{bus.id}" style="font-weight: bold"/>
	                        
	                        <h:outputText value="Name:" />
	                        <h:outputText value="#{bus.name}" style="font-weight: bold"/>
	 
	                        <h:outputText value="Time:" />
	                        <h:outputText value="#{bus.runningtime}" style="font-weight: bold"/>
	 
	                        <h:outputText value="Price:" />
	                        <h:outputText value="#{bus.price}" style="font-weight: bold"/>
	                        <!-- 
	                        <h:outputText value="Available Seats:" />
	                        <h:outputText value="#{bus.availableseats}" style="font-weight: bold"/>
	                         -->
	                    </h:panelGrid>
	                </p:outputPanel>
	 
	                 <!-- 
	                    <p:commandLink update="booking_form:busDetail" oncomplete="PF('busDialog').show()" title="View Detail">
	                    <p:commandLink action="#{bookingModel.getResult()}">
	                        <h:outputText styleClass="ui-icon pi pi-search" style="margin:0 auto;" />
	                    </p:commandLink>
						   		<f:param name = "busid" value = "#{bus.id}" /> 
	                    --> 
	                    
	                        <h:commandButton value="book" action="#{selectedBusModel.getResult()}" styleClass="booking-page-button">
	                        	<f:setPropertyActionListener value="#{bus}" target="#{selectedBusBean.selectedBus}" />
						   	</h:commandButton>
	            </h:panelGrid>
	        </p:dataViewListItem>
	    </p:dataView>
	 <!-- 
	 	<p:dataTable id="booking_table" var="bus" value="#{busView.buses}">
		    <p:column headerText="Name">
	            <h:outputText value="#{bus.name}" style="font-weight: bold"/>
		    </p:column>
		 
		    <p:column headerText="Time">
	            <h:outputText value="#{bus.runningtime}" style="font-weight: bold"/>
		    </p:column>
		 
		    <p:column headerText="Price">
	            <h:outputText value="#{bus.price}" style="font-weight: bold"/>
		    </p:column>
		 
		    <p:column headerText="Available Seats">
	            <h:outputText value="#{bus.availableseats}" style="font-weight: bold"/>
		    </p:column>
		    <p:column headerText="book">
	            <p:commandButton value="book" onclick="selectedBusFunction('#{bus.id}')" action="#{bookingModel.getResult()}"/>
		    </p:column>
	    <f:facet name="footer">
			<p:inputText id="selected_bus_field" styleClass="hidden" value="#{busView.selectedBus}"/>
		</f:facet>
		</p:dataTable>
	  -->
	 
	    <p:dialog header="Bus Info" widgetVar="busDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false">
	        <p:outputPanel id="busDetail" style="text-align:center;">
	            <p:panelGrid  columns="2" columnClasses="label,value">
							<h:outputText value="Name:" />
	                        <h:outputText value="#{busView.selectedBus.name}" style="font-weight: bold"/>
	 
	                        <h:outputText value="Time:" />
	                        <h:outputText value="#{busView.selectedBus.runningtime}" style="font-weight: bold"/>
	 
	                        <h:outputText value="Price:" />
	                        <h:outputText value="#{busView.selectedBus.price}" style="font-weight: bold"/>
	                        
	                        <h:outputText value="Available Seats:" />
	                        <h:outputText value="#{busView.selectedBus.availableseats}" style="font-weight: bold"/>	
	                        
	                        <h:inputHidden/>
	                        <h:commandButton value="book" action="#{bookingModel.getResult()}">
						   		<f:param name = "busid" value = "#{busView.selectedBus.id}" /> 
						   	</h:commandButton>
	            </p:panelGrid>
	        </p:outputPanel>
	    </p:dialog>
	 <!-- 
	  -->
	</h:form>
	<footer class="footer center">&copy;SampleApplication.com</footer>
</h:body>
</html>